{% if messages %}
<div class="fixed top-20 right-4 z-50 w-full max-w-sm space-y-2" x-data="{ messages: [] }" x-init="
    // Initialize with current messages
    messages = [
        {% for message in messages %}
            { id: '{{ forloop.counter }}', text: '{{ message|escapejs }}', type: '{{ message.tags }}', show: true }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];
    
    // Auto-remove messages after delay
    messages.forEach((msg, index) => {
        setTimeout(() => {
            msg.show = false;
            // Remove from DOM after animation
            setTimeout(() => {
                messages = messages.filter(m => m.id !== msg.id);
            }, 200);
        }, 5000);
    });
">
    <template x-for="message in messages" :key="message.id">
        <div 
            x-show="message.show"
            x-transition:enter="transition ease-out duration-300"
            x-transition:enter-start="opacity-0 translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            x-transition:leave="transition ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0"
            x-transition:leave-end="opacity-0 translate-y-2"
            @click.away="message.show = false"
            class="rounded-md p-4 shadow-lg transform transition-all duration-300 ease-in-out hover:scale-[1.02]"
            :class="{
                'bg-green-100 border-l-4 border-green-500 text-green-700': message.type.includes('success'),
                'bg-blue-100 border-l-4 border-blue-500 text-blue-700': message.type.includes('info') || !message.type,
                'bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700': message.type.includes('warning'),
                'bg-red-100 border-l-4 border-red-500 text-red-700': message.type.includes('error')
            }"
        >
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    <template x-if="message.type.includes('success')">
                        <i class="fas fa-check-circle text-green-500"></i>
                    </template>
                    <template x-if="message.type.includes('info') || !message.type">
                        <i class="fas fa-info-circle text-blue-500"></i>
                    </template>
                    <template x-if="message.type.includes('warning')">
                        <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                    </template>
                    <template x-if="message.type.includes('error')">
                        <i class="fas fa-exclamation-circle text-red-500"></i>
                    </template>
                </div>
                <div class="ml-3 flex-1">
                    <p class="text-sm font-medium" x-text="message.text"></p>
                </div>
                <div class="ml-4 flex-shrink-0">
                    <button 
                        @click="message.show = false; setTimeout(() => { messages = messages.filter(m => m.id !== message.id) }, 200)"
                        class="inline-flex text-gray-500 hover:text-gray-700 focus:outline-none"
                        aria-label="Dismiss message"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </div>
    </template>
</div>
{% endif %}